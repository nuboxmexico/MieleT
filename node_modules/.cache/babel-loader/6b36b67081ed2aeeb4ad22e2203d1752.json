{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/javascript/components/services/visits/CanceVisitDialog.jsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Link from '@material-ui/core/Link';\nimport { flash_alert } from 'components/App';\nimport Typography from '@material-ui/core/Typography';\nimport Radio from '@material-ui/core/Radio';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport { csrf, headers, money_format, date_format, date_event_format, date_difference_in_hours } from \"constants/csrf\";\nimport { useTranslation } from 'react-i18next';\n\nfunction CanceVisitDialog(props) {\n  var _useTranslation = useTranslation('translation', {\n    keyPrefix: 'services.visits.cancelServiceButton'\n  }),\n      t = _useTranslation.t;\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      canceVisitDialog = _React$useState2[0],\n      setCanceVisitDialog = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      cancelReason = _React$useState4[0],\n      setCancelReason = _React$useState4[1];\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      backgroundCancelVisit = _useState2[0],\n      setBackgroundCancelVisit = _useState2[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      doCancelService = _React$useState6[0],\n      setDoCancelService = _React$useState6[1];\n\n  var handleChange = function handleChange(event) {\n    setCancelReason(event.target.value);\n  };\n\n  function handleClose(e) {\n    e.preventDefault();\n    setCanceVisitDialog(false);\n  }\n\n  function handleCancelVisit(_x) {\n    return _handleCancelVisit.apply(this, arguments);\n  }\n\n  function _handleCancelVisit() {\n    _handleCancelVisit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              cancelVisit(props.visit.id);\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _handleCancelVisit.apply(this, arguments);\n  }\n\n  function cancelVisit(visit_id) {\n    var body = new FormData();\n    body.set('cancel_from', cancelReason);\n    body.set('cancel_reason', backgroundCancelVisit);\n    return axios.post(\"/api/v1/services/\".concat(props.serviceID, \"/visits/\").concat(visit_id, \"/cancel_visit\"), body, {\n      headers: headers\n    }).then(function (response) {\n      flash_alert(t('flashAlert.saved'), t('flashAlert.cancelVisit'), \"success\");\n      props.callbacks();\n      setCanceVisitDialog(false);\n    })[\"catch\"](function (e) {\n      if (e.response.data) {\n        console.log(e.response.data);\n        setCanceVisitDialog(false);\n        props.callbacks();\n\n        for (var key in e.response.data) {\n          flash_alert(t('globalText.error'), e.response.data[key], \"danger\");\n        }\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    className: props.classes.heading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    disabled: props.visit.canceled_at != null,\n    className: props.btn_classname + \"customers-scheddule-visit-link\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return setCanceVisitDialog(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Tooltip, {\n    title: /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"service-tooltip\",\n      dangerouslySetInnerHTML: {\n        __html: t('flashAlert.cancelTooltip') || \"\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 29\n      }\n    })),\n    arrow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 27\n    }\n  }, \"close\")))), /*#__PURE__*/React.createElement(Dialog, {\n    open: canceVisitDialog,\n    fullWidth: true,\n    maxWidth: \"sm\",\n    onClose: handleClose,\n    \"aria-labelledby\": \"alert-dialog-title\",\n    \"aria-describedby\": \"alert-dialog-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DialogTitle, {\n    className: \"payment-dialog-title\",\n    id: \"alert-dialog-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, t('flashAlert.cancelMessage')), /*#__PURE__*/React.createElement(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(DialogContentText, {\n    id: \"alert-dialog-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(FormControl, {\n    component: \"fieldset\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(RadioGroup, {\n    \"aria-label\": \"gender\",\n    name: \"gender1\",\n    value: cancelReason,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FormControlLabel, {\n    value: \"Desde Miele\",\n    control: /*#__PURE__*/React.createElement(Radio, {\n      color: \"primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 80\n      }\n    }),\n    label: t('fromMiele'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    value: \"Desde Cliente\",\n    control: /*#__PURE__*/React.createElement(Radio, {\n      color: \"primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 82\n      }\n    }),\n    label: t('fromCustomer'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 33\n    }\n  })))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    fullWidth: true,\n    variant: \"outlined\",\n    multiline: true,\n    rows: 8,\n    label: t('reasons'),\n    name: \"background\",\n    value: backgroundCancelVisit,\n    onChange: function onChange(e) {\n      return setBackgroundCancelVisit(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 25\n    }\n  }))))), /*#__PURE__*/React.createElement(DialogActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: handleClose,\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }, t('backButton')), /*#__PURE__*/React.createElement(Button, {\n    onClick: handleCancelVisit,\n    id: \"payment-email-send\",\n    variant: \"contained\",\n    color: \"primary\",\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, t('cancelVisitButton')))));\n}\n\nvar structuredSelector = createStructuredSelector({});\nvar mapDispatchToProps = {};\nexport default connect(structuredSelector, mapDispatchToProps)(CanceVisitDialog);","map":{"version":3,"sources":["/usr/src/app/javascript/components/services/visits/CanceVisitDialog.jsx"],"names":["React","useState","useEffect","axios","connect","createStructuredSelector","TextField","Grid","FormControl","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Link","flash_alert","Typography","Radio","RadioGroup","FormControlLabel","Tooltip","FormLabel","csrf","headers","money_format","date_format","date_event_format","date_difference_in_hours","useTranslation","CanceVisitDialog","props","keyPrefix","t","canceVisitDialog","setCanceVisitDialog","cancelReason","setCancelReason","backgroundCancelVisit","setBackgroundCancelVisit","doCancelService","setDoCancelService","handleChange","event","target","value","handleClose","e","preventDefault","handleCancelVisit","cancelVisit","visit","id","visit_id","body","FormData","set","post","serviceID","then","response","callbacks","data","console","log","key","classes","heading","canceled_at","btn_classname","__html","structuredSelector","mapDispatchToProps"],"mappings":"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","sourcesContent":["\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from \"react-redux\"\nimport { createStructuredSelector } from \"reselect\"\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Link from '@material-ui/core/Link';\nimport { flash_alert } from 'components/App';\nimport Typography from '@material-ui/core/Typography';\nimport Radio from '@material-ui/core/Radio';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\n\nimport Tooltip from '@material-ui/core/Tooltip';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport {csrf, headers, money_format, date_format,date_event_format, date_difference_in_hours} from \"constants/csrf\"\nimport { useTranslation } from 'react-i18next';\n\nfunction CanceVisitDialog(props){\n    const { t } = useTranslation('translation', { keyPrefix: 'services.visits.cancelServiceButton' });\n    const [canceVisitDialog, setCanceVisitDialog] = React.useState(false);\n    const [cancelReason, setCancelReason] = React.useState('');\n    const [backgroundCancelVisit, setBackgroundCancelVisit] = useState(\"\");\n    const [doCancelService, setDoCancelService] = React.useState(false);\n    \n    const handleChange = (event) => {\n        setCancelReason(event.target.value);\n    }\n\tfunction handleClose(e){\n\t\te.preventDefault();\n\t\tsetCanceVisitDialog(false);\n\t}\n\n\tasync function handleCancelVisit(e){\n        e.preventDefault();\n        cancelVisit(props.visit.id)\n    }\n\n\n    function cancelVisit(visit_id){\n        var body = new FormData();\n        \n        \n        body.set('cancel_from', cancelReason);\n        body.set('cancel_reason', backgroundCancelVisit);\n        return axios.post(`/api/v1/services/${props.serviceID}/visits/${visit_id}/cancel_visit`, body, { headers: headers})\n            .then(response => {\n                flash_alert(t('flashAlert.saved'), t('flashAlert.cancelVisit'), \"success\")\n                props.callbacks();\n                setCanceVisitDialog(false);\n            })\n            .catch(e => {\n            if(e.response.data){\n                console.log(e.response.data);\n                setCanceVisitDialog(false);\n                props.callbacks();\n                for (var key in e.response.data) {\n                    flash_alert(t('globalText.error'), e.response.data[key], \"danger\")\n                }\n            }\n        });\n    }\n\treturn (\n\t\t<React.Fragment>\n            <Typography className={props.classes.heading}>\n                <Button disabled={props.visit.canceled_at != null} className={props.btn_classname + \"customers-scheddule-visit-link\"} color=\"primary\" onClick={() =>  setCanceVisitDialog(true)}>\n                    <Tooltip title={\n                        <React.Fragment>\n                            <div className=\"service-tooltip\" dangerouslySetInnerHTML={{__html: ( t('flashAlert.cancelTooltip') || \"\")}} /> \n                        </React.Fragment>} arrow>\n                        { <i className=\"material-icons\">close</i> }\n                    </Tooltip>\n                </Button>\n            </Typography>\n\t\t  <Dialog\n\t\t\topen={canceVisitDialog}\n\t\t\tfullWidth={true}\n        \tmaxWidth={\"sm\"}\n\t\t    onClose={handleClose}\n\t\t    aria-labelledby=\"alert-dialog-title\"\n\t\t    aria-describedby=\"alert-dialog-description\"\n\t\t  >\n\t\t    <DialogTitle className=\"payment-dialog-title\" id=\"alert-dialog-title\">{t('flashAlert.cancelMessage')}</DialogTitle>\n\t\t    <DialogContent>\n\t\t      <DialogContentText id=\"alert-dialog-description\">\n\t\t\t\t<Grid container spacing={1}> \n                    <Grid item xs={12}>\n                        <FormControl component=\"fieldset\">\n                            <RadioGroup aria-label=\"gender\" name=\"gender1\" value={cancelReason} onChange={handleChange}>\n                                <FormControlLabel value=\"Desde Miele\" control={<Radio color=\"primary\" />} label={t('fromMiele')} />\n                                <FormControlLabel value=\"Desde Cliente\" control={<Radio color=\"primary\" />} label={t('fromCustomer')} />\n                            </RadioGroup>\n                        </FormControl>\n                    </Grid>\n\t\t\t\t\t<Grid item xs={12}>\n                        <TextField fullWidth variant=\"outlined\" multiline rows={8} label={t('reasons')} name=\"background\" value={backgroundCancelVisit} onChange={(e) => setBackgroundCancelVisit(e.target.value)}/>\n\t\t\t\t\t</Grid>\n\t\t\t\t</Grid>  \n\t\t      </DialogContentText>\n\t\t    </DialogContent>\n\t\t    <DialogActions>\n\t\t      <Button onClick={handleClose} color=\"primary\">\n                {t('backButton')}\n\t\t      </Button>\n\t\t      <Button onClick={handleCancelVisit} id=\"payment-email-send\"  variant=\"contained\" color=\"primary\" autoFocus>\n                {t('cancelVisitButton')}\n\t\t      </Button>\n\t\t    </DialogActions>\n\t\t  </Dialog>\n\t\t</React.Fragment>\n\t);\n  \n}\n\nconst structuredSelector = createStructuredSelector({ });\nconst mapDispatchToProps = {};\n\nexport default connect(structuredSelector, mapDispatchToProps)(CanceVisitDialog)\n"]},"metadata":{},"sourceType":"module"}