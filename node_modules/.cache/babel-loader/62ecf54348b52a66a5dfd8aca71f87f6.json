{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/javascript/components/services/visits/VisitRequestedSpareParts.jsx\",\n    _this = this;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport { flash_alert } from 'components/App';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Button from '@material-ui/core/Button';\nimport MaterialTable from 'react-data-table-component';\nimport Radio from '@material-ui/core/Radio';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport { csrf, headers, money_format, date_event_format, date_difference_in_hours, api_token, site_url, payment_channel_label } from \"constants/csrf\";\nimport { useTranslation } from 'react-i18next';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport i18next from 'i18next';\nvar GET_SELECTED_SPARE_PARTS_REQUEST = \"GET_SELECTED_SPARE_PARTS_REQUEST\";\nvar GET_SELECTED_SPARE_PARTS_SUCCESS = \"GET_SELECTED_SPARE_PARTS_SUCCESS\";\nvar spare_part_columns = [{\n  name: 'TNR',\n  selector: 'spare_part.tnr',\n  sortable: true,\n  hide: 'sm'\n}, {\n  name: 'Nombre',\n  selector: 'spare_part.name',\n  sortable: true\n}, {\n  name: 'Cantidad',\n  selector: 'quantity',\n  sortable: true,\n  hide: 'md'\n}, {\n  name: 'Garantía',\n  selector: 'warranty',\n  sortable: true,\n  hide: 'md'\n}, {\n  name: 'Precio',\n  selector: 'price',\n  sortable: true,\n  hide: 'md',\n  cell: function cell(row) {\n    return /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }\n    }, money_format(row.country, row.price));\n  }\n}];\n\nfunction getSpareParts(customer_product_id, visit_id, setUserLoading) {\n  return function (dispatch) {\n    dispatch({\n      type: GET_SELECTED_SPARE_PARTS_REQUEST\n    });\n    return fetch(\"/api/v1/customer_products/\".concat(customer_product_id, \"/customer_product_requested_spare_parts?visit_id=\").concat(visit_id)).then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      return dispatch(getSparePartsSuccess(json)) && setUserLoading(false);\n    })[\"catch\"](function (error) {\n      return console.log(error) && setUserLoading(false);\n    });\n  };\n}\n\n;\nexport function getSparePartsSuccess(json) {\n  return {\n    type: GET_SELECTED_SPARE_PARTS_SUCCESS,\n    json: json\n  };\n}\n;\n\nfunction VisitRequestedSpareParts(props) {\n  var _this2 = this,\n      _React$createElement;\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var _useState = useState(props.visit.customer_products.length > 0 && props.visit.customer_products[0].id || \"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      checked = _useState2[0],\n      setChecked = _useState2[1];\n\n  var _useState3 = useState(props.visit.customer_products && props.visit.customer_products[0] || {}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedCustomerProduct = _useState4[0],\n      setSelectedCustomerProduct = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      userLoading = _useState6[0],\n      setUserLoading = _useState6[1];\n\n  useEffect(function () {\n    setUserLoading(true);\n\n    if (selectedCustomerProduct) {\n      props.getSpareParts(selectedCustomerProduct.id, props.visit.id, setUserLoading);\n    }\n\n    setUserLoading(false);\n  }, [selectedCustomerProduct]);\n\n  function handleToggle(customer_product) {\n    setChecked(customer_product.id);\n    setSelectedCustomerProduct(customer_product);\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"service-subtitle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, t('services.visits.productTableInfo.requestSpareParts')), /*#__PURE__*/React.createElement(List, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, props.visit.customer_products && props.visit.customer_products.map(function (customer_product) {\n    var listId = \"list-visit-products-\".concat(props.visit.id, \"-\").concat(customer_product.id);\n    var labelId = \"visit-products-\".concat(props.visit.id, \"-\").concat(customer_product.id);\n    return /*#__PURE__*/React.createElement(ListItem, {\n      key: listId,\n      role: undefined,\n      dense: true,\n      button: true,\n      onClick: function onClick() {\n        return handleToggle(customer_product);\n      },\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(ListItemIcon, {\n      className: \"service-address-label\",\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(FormControlLabel, {\n      value: customer_product.id,\n      control: /*#__PURE__*/React.createElement(Radio, {\n        color: \"primary\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 80\n        }\n      }),\n      label: \"\",\n      checked: checked == customer_product.id,\n      tabIndex: -1,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(ListItemText, {\n      id: labelId,\n      secondary: /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        spacing: 1,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 4,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-1\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 41\n        }\n      }, t('services.visits.productTableInfo.name')), /*#__PURE__*/React.createElement(\"br\", {\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 126\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-2\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 41\n        }\n      }, customer_product.product.name)), /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 3,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-1\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 41\n        }\n      }, t('services.visits.productTableInfo.tnr')), /*#__PURE__*/React.createElement(\"br\", {\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 125\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-2\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 41\n        }\n      }, customer_product.product.tnr)), /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 3,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-1\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 41\n        }\n      }, t('services.visits.productTableInfo.id')), /*#__PURE__*/React.createElement(\"br\", {\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 124\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-2\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 41\n        }\n      }, customer_product.serial_id)), /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 2,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-1\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 41\n        }\n      }, t('services.visits.productTableInfo.status')), /*#__PURE__*/React.createElement(\"br\", {\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 128\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"visit-summary-2\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 41\n        }\n      }, customer_product.status))),\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(ListItemSecondaryAction, {\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 25\n      }\n    }));\n  })), /*#__PURE__*/React.createElement(Grid, {\n    style: {\n      marginTop: \"15px\"\n    },\n    container: true,\n    spacing: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(MaterialTable, (_React$createElement = {\n    noHeader: true,\n    columns: spare_part_columns,\n    data: props.spare_parts,\n    progressPending: userLoading,\n    progressComponent: /*#__PURE__*/React.createElement(CircularProgress, {\n      size: 75,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 48\n      }\n    }),\n    responsive: true,\n    highlightOnHover: true,\n    striped: true,\n    contextMessage: {\n      singular: 'producto',\n      plural: 'productos',\n      message: 'seleccionados'\n    }\n  }, _defineProperty(_React$createElement, \"highlightOnHover\", true), _defineProperty(_React$createElement, \"striped\", true), _defineProperty(_React$createElement, \"noDataComponent\", i18next.t('globalText.NoDataComponent')), _defineProperty(_React$createElement, \"paginationComponentOptions\", {\n    rowsPerPageText: i18next.t('globalText.rowsPerPageText'),\n    rangeSeparatorText: i18next.t('globalText.rangeSeparatorText'),\n    noRowsPerPage: false,\n    selectAllRowsItem: false,\n    selectAllRowsItemText: i18next.t('globalText.selectAllRowsItemText')\n  }), _defineProperty(_React$createElement, \"__self\", this), _defineProperty(_React$createElement, \"__source\", {\n    fileName: _jsxFileName,\n    lineNumber: 153,\n    columnNumber: 25\n  }), _React$createElement)))));\n}\n\nvar structuredSelector = createStructuredSelector({\n  spare_parts: function spare_parts(state) {\n    return state.selected_spare_parts;\n  },\n  page: function page(state) {\n    return state.page;\n  },\n  perPage: function perPage(state) {\n    return state.perPage;\n  },\n  total: function total(state) {\n    return state.total;\n  },\n  current_user: function current_user(state) {\n    return state.current_user;\n  }\n});\nvar mapDispatchToProps = {\n  getSpareParts: getSpareParts\n};\nexport default connect(structuredSelector, mapDispatchToProps)(VisitRequestedSpareParts);","map":{"version":3,"sources":["/usr/src/app/javascript/components/services/visits/VisitRequestedSpareParts.jsx"],"names":["React","useState","useEffect","axios","connect","createStructuredSelector","flash_alert","createStyles","makeStyles","CircularProgress","Paper","Grid","Button","MaterialTable","Radio","List","ListItem","ListItemIcon","ListItemSecondaryAction","ListItemText","FormControlLabel","csrf","headers","money_format","date_event_format","date_difference_in_hours","api_token","site_url","payment_channel_label","useTranslation","Skeleton","i18next","GET_SELECTED_SPARE_PARTS_REQUEST","GET_SELECTED_SPARE_PARTS_SUCCESS","spare_part_columns","name","selector","sortable","hide","cell","row","country","price","getSpareParts","customer_product_id","visit_id","setUserLoading","dispatch","type","fetch","then","response","json","getSparePartsSuccess","error","console","log","VisitRequestedSpareParts","props","t","visit","customer_products","length","id","checked","setChecked","selectedCustomerProduct","setSelectedCustomerProduct","userLoading","handleToggle","customer_product","map","listId","labelId","undefined","product","tnr","serial_id","status","marginTop","spare_parts","singular","plural","message","rowsPerPageText","rangeSeparatorText","noRowsPerPage","selectAllRowsItem","selectAllRowsItemText","structuredSelector","state","selected_spare_parts","page","perPage","total","current_user","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from \"react-redux\"\nimport { createStructuredSelector } from \"reselect\";\nimport { flash_alert } from 'components/App';\n\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Button from '@material-ui/core/Button'\nimport MaterialTable from 'react-data-table-component';\nimport Radio from '@material-ui/core/Radio';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport {csrf, headers, money_format, date_event_format, date_difference_in_hours, api_token, site_url, payment_channel_label} from \"constants/csrf\"\nimport {useTranslation} from 'react-i18next';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport i18next from 'i18next'\n\nconst GET_SELECTED_SPARE_PARTS_REQUEST = \"GET_SELECTED_SPARE_PARTS_REQUEST\";\nconst GET_SELECTED_SPARE_PARTS_SUCCESS = \"GET_SELECTED_SPARE_PARTS_SUCCESS\";\n\nconst spare_part_columns = [\n    {\n      name: 'TNR',\n      selector: 'spare_part.tnr',\n      sortable: true,\n      hide: 'sm',\n    },\n    {\n      name: 'Nombre',\n      selector: 'spare_part.name',\n      sortable: true,\n    },\n    {\n        name: 'Cantidad',\n        selector: 'quantity',\n        sortable: true,\n        hide: 'md',\n    },\n    {\n        name: 'Garantía',\n        selector: 'warranty',\n        sortable: true,\n        hide: 'md',\n    },\n    {\n        name: 'Precio',\n        selector: 'price',\n        sortable: true,\n        hide: 'md',\n        cell: row => (\n          <span>\n            {(money_format(row.country, row.price))}\n          </span>\n        ),\n    }\n    \n    \n];\n\nfunction getSpareParts(customer_product_id, visit_id, setUserLoading) {\n    return dispatch => {\n        dispatch({type: GET_SELECTED_SPARE_PARTS_REQUEST});\n        return fetch(`/api/v1/customer_products/${customer_product_id}/customer_product_requested_spare_parts?visit_id=${visit_id}`)\n        .then(response => response.json())\n        .then(json => dispatch(getSparePartsSuccess(json)) && setUserLoading(false))\n        .catch(error => console.log(error) && setUserLoading(false));\n    };\n};\nexport function getSparePartsSuccess(json) {\n    return {\n        type: GET_SELECTED_SPARE_PARTS_SUCCESS,\n        json\n    };\n};\n\n\nfunction VisitRequestedSpareParts(props){\n    const {t} = useTranslation();\n    const [checked, setChecked] = useState((props.visit.customer_products.length > 0 && props.visit.customer_products[0].id || \"\"));\n    const [selectedCustomerProduct, setSelectedCustomerProduct] = useState((props.visit.customer_products && props.visit.customer_products[0] || {}));\n    const [userLoading, setUserLoading] = useState(false);\n    \n    useEffect(() => {\n        setUserLoading(true)\n        if(selectedCustomerProduct){\n            props.getSpareParts(selectedCustomerProduct.id, props.visit.id , setUserLoading);\n        }\n        setUserLoading(false)\n    }, [selectedCustomerProduct]);\n\n    function handleToggle(customer_product){\n        setChecked(customer_product.id)\n        setSelectedCustomerProduct(customer_product)\n    }\n\n\treturn (\n\t\t<React.Fragment>\n            <p className=\"service-subtitle\">{t('services.visits.productTableInfo.requestSpareParts')}</p>\n            <List>\n                {props.visit.customer_products && props.visit.customer_products.map((customer_product) => {\n                    const listId = `list-visit-products-${props.visit.id}-${customer_product.id}`;\n                    const labelId = `visit-products-${props.visit.id}-${customer_product.id}`;\n\n                    return (\n                    <ListItem key={listId} role={undefined} dense button onClick={() => handleToggle(customer_product)}>\n                        <ListItemIcon className=\"service-address-label\">\n                        <FormControlLabel value={customer_product.id} control={<Radio color=\"primary\"/>} label=\"\" checked={checked == customer_product.id}\n                            tabIndex={-1}\n                        />\n                        </ListItemIcon>\n                        <ListItemText \n                            id={labelId}\n                            secondary={\n                                <Grid container spacing={1}>\n                                    <Grid item xs={12} sm={4}>\n                                        <span className=\"visit-summary-1\">{t('services.visits.productTableInfo.name')}</span><br/>\n                                        <span className=\"visit-summary-2\">{customer_product.product.name}</span>\n                                    </Grid>\n                                    <Grid item xs={12} sm={3}>\n                                        <span className=\"visit-summary-1\">{t('services.visits.productTableInfo.tnr')}</span><br/>\n                                        <span className=\"visit-summary-2\">{customer_product.product.tnr}</span>\n                                    </Grid>\n                                    <Grid item xs={12} sm={3}>\n                                        <span className=\"visit-summary-1\">{t('services.visits.productTableInfo.id')}</span><br/>\n                                        <span className=\"visit-summary-2\">{customer_product.serial_id}</span>\n                                    </Grid>\n                                    <Grid item xs={12} sm={2}>\n                                        <span className=\"visit-summary-1\">{t('services.visits.productTableInfo.status')}</span><br/>\n                                        <span className=\"visit-summary-2\">{customer_product.status}</span>\n                                    </Grid>\n                                </Grid>\n                            } \n                        />\n                        \n                    \n                        <ListItemSecondaryAction>\n                        \n                        </ListItemSecondaryAction>\n                    </ListItem>\n                    );\n                })}\n                \n                </List>\n                <Grid style={{marginTop: \"15px\"}} container spacing={1}>\n                    <Grid item xs={12}>\n                        <MaterialTable\n                        noHeader={true}\n                            columns={spare_part_columns}\n                            data={props.spare_parts}\n                            progressPending={userLoading}\n                            progressComponent={<CircularProgress size={75} />}\n                            responsive={true}\n                            highlightOnHover={true}\n                            striped={true}\n                            contextMessage={{ singular: 'producto', plural: 'productos', message: 'seleccionados' }}\n                            highlightOnHover={true}\n                            striped={true}\n                            noDataComponent={i18next.t('globalText.NoDataComponent')}\n                            paginationComponentOptions={{rowsPerPageText: i18next.t('globalText.rowsPerPageText'), rangeSeparatorText: i18next.t('globalText.rangeSeparatorText'), noRowsPerPage: false, selectAllRowsItem: false, selectAllRowsItemText: i18next.t('globalText.selectAllRowsItemText') }}\n                        />\n                    </Grid>\n                </Grid>\n\t\t</React.Fragment>\n\t);\n  \n}\n\nconst structuredSelector = createStructuredSelector({\n    spare_parts: state => state.selected_spare_parts,\n    page: state => state.page,\n    perPage: state => state.perPage,\n    total: state => state.total,\n    current_user: state => state.current_user,\n});\nconst mapDispatchToProps = {getSpareParts};\nexport default connect(structuredSelector, mapDispatchToProps)(VisitRequestedSpareParts)\n\n"]},"metadata":{},"sourceType":"module"}