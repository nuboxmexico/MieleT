{"ast":null,"code":"var _excluded = [\"inputRef\", \"onChange\"];\nvar _jsxFileName = \"/usr/src/app/javascript/components/services/EditSparePartDialog.jsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Link from '@material-ui/core/Link';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport NumberFormat from 'react-number-format';\nimport PropTypes from 'prop-types';\nimport { spare_part_delivery_status_label } from \"constants/service_functions\";\nimport { flash_alert } from 'components/App';\nvar EDIT_SPARE_PART = \"EDIT_SPARE_PART\";\nvar EDITED_SPARE_PART = \"EDITED_SPARE_PART\";\nvar SPARE_PART_DELIVERY_STATUS = ['waiting', 'in_transit', 'delivered'];\n\nfunction NumberFormatCustom(props) {\n  var inputRef = props.inputRef,\n      onChange = props.onChange,\n      other = _objectWithoutProperties(props, _excluded);\n\n  return /*#__PURE__*/React.createElement(NumberFormat, Object.assign({}, other, {\n    getInputRef: inputRef,\n    onValueChange: function onValueChange(values) {\n      onChange({\n        target: {\n          name: props.name,\n          value: values.value\n        }\n      });\n    },\n    thousandSeparator: true,\n    isNumericString: true,\n    prefix: \"$ \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 4\n    }\n  }));\n}\n\nNumberFormatCustom.propTypes = {\n  inputRef: PropTypes.func.isRequired,\n  name: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nfunction editSparePart(service_id, quotation_id, service_spare_part_id, quantity, requested_quantity, delivery_status, background, price, warranty, from, headers, callbacks) {\n  return function (dispatch) {\n    dispatch({\n      type: EDIT_SPARE_PART\n    });\n    var body = new FormData();\n    body.set('id', service_id);\n\n    if (from == \"request\") {\n      body.set('requested_quantity', requested_quantity);\n      body.set('delivery_status', delivery_status);\n      body.set('background', background);\n    } else {\n      body.set('quantity', quantity);\n    }\n\n    if (from == \"quotation\") {\n      body.set('quotation_spare_part_id', service_spare_part_id);\n      body.set('price', price);\n      body.set('warranty', warranty);\n      return axios.patch(\"/api/v1/quotations/\".concat(quotation_id, \"/spare_parts/\").concat(service_spare_part_id), body, {\n        headers: headers\n      }).then(function (response) {\n        flash_alert(\"Actualizado!\", \"Refacci贸n actualizada correctamente\", \"success\");\n        callbacks();\n      })[\"catch\"](function (e) {\n        flash_alert(\"Error!\", \"No se ha podido actualizar la refacci贸n\", \"danger\");\n        console.log(e);\n      });\n    } else {\n      body.set('service_spare_part_id', service_spare_part_id);\n      return axios.patch(\"/api/v1/services/\".concat(service_id, \"/spare_parts/\").concat(service_spare_part_id), body, {\n        headers: headers\n      }).then(function (response) {\n        flash_alert(\"Actualizado!\", \"Refacci贸n actualizada correctamente\", \"success\");\n        dispatch({\n          type: EDITED_SPARE_PART,\n          response: response\n        });\n        callbacks && callbacks();\n      })[\"catch\"](function (e) {\n        flash_alert(\"Error!\", \"No se ha podido actualizar la refacci贸n\", \"danger\");\n        console.log(e);\n      });\n    }\n  };\n}\n\n;\n\nfunction EditSparePartDialog(props) {\n  var _this = this;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      quantity = _useState4[0],\n      setQuantity = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      price = _useState6[0],\n      setPrice = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      firstTime = _useState8[0],\n      setFirstTime = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      requested_quantity = _useState10[0],\n      setRequestedQuantity = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      from = _useState12[0],\n      setFrom = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      _useState14 = _slicedToArray(_useState13, 2),\n      delivery_status = _useState14[0],\n      setDeliveryStatus = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      background = _useState16[0],\n      setBackground = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      warranty = _useState18[0],\n      setWarranty = _useState18[1];\n\n  useEffect(function () {\n    setQuantity(props.quantity);\n  }, [props.quantity]);\n  useEffect(function () {\n    if (props.price) {\n      setPrice(props.price);\n    }\n\n    props.price == 0 && setWarranty(true);\n  }, [props.price]);\n  useEffect(function () {\n    if (price) {\n      price == 0 ? null : setWarranty(false);\n    }\n  }, [price]);\n  useEffect(function () {\n    if (!warranty) {\n      if (props.original_price && !firstTime) {\n        setPrice(props.original_price);\n      } else {\n        setPrice(props.price);\n      }\n    } else {\n      setPrice(0);\n    }\n\n    firstTime && setFirstTime(false);\n  }, [warranty]);\n  useEffect(function () {\n    setRequestedQuantity(props.requested_quantity);\n  }, [props.requested_quantity]);\n  useEffect(function () {\n    setDeliveryStatus(props.delivery_status);\n  }, [props.delivery_status]);\n  useEffect(function () {\n    setBackground(props.background);\n  }, [props.background]);\n  useEffect(function () {\n    setFrom(props.from);\n\n    if (props.from == \"request\") {\n      setQuantity(props.requested_quantity);\n    }\n  }, [props.from]);\n\n  function handleClickOpen(e) {\n    e.preventDefault();\n    setOpen(true);\n  }\n\n  function handleClose(e) {\n    e.preventDefault();\n    setOpen(false);\n  }\n\n  function handleEdit(_x) {\n    return _handleEdit.apply(this, arguments);\n  }\n\n  function _handleEdit() {\n    _handleEdit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              setOpen(false);\n              props.editSparePart(props.service_id, props.quotation_id, props.service_spare_part_id, quantity, requested_quantity, delivery_status, background, price, warranty, from, props.headers, props.callbacks);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _handleEdit.apply(this, arguments);\n  }\n\n  function handleQuantity(e) {\n    if (e.target.value < 1 || e.target.value > 99) {\n      flash_alert(\"Error!\", \"Debe ingresar una cantidad entre 1 y 99\", \"danger\");\n    } else {\n      setQuantity(e.target.value);\n      setRequestedQuantity(e.target.value);\n    }\n  }\n\n  function handleWarrantyChange(e) {\n    setWarranty(!warranty);\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    href: \"#\",\n    id: \"editspareparts_\" + props.customer_id,\n    className: \"mdl-navigation__link brand-primary-link sparepart-edit-link  mg-r-15\",\n    onClick: handleClickOpen,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"material-icons material-icons-20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 168\n    }\n  }, \"edit\"), \" Editar\"), /*#__PURE__*/React.createElement(Dialog, {\n    open: open,\n    fullWidth: true,\n    maxWidth: \"sm\",\n    onClose: handleClose,\n    \"aria-labelledby\": \"alert-dialog-title\",\n    \"aria-describedby\": \"alert-dialog-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DialogTitle, {\n    className: \"edit-sparepart-dialog-title\",\n    id: \"alert-dialog-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }\n  }, \"Editar refacci贸n\"), /*#__PURE__*/React.createElement(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(DialogContentText, {\n    id: \"alert-dialog-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 12,\n    className: \"edit-sparepart-dialog-product-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 6\n    }\n  }, props.name, \" (\", props.tnr, \")\"), props.from == \"request\" && /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(FormControl, {\n    variant: \"outlined\",\n    className: \"MuiFormControl-fullWidth\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    id: \"spare_part_delivery_status-simple-select-outlined-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 11\n    }\n  }, \"Estado de entrega\"), /*#__PURE__*/React.createElement(Select, {\n    labelId: \"spare_part_delivery_status-simple-select-outlined-label\",\n    id: \"spare_part_delivery_status-simple-select-outlined\",\n    value: delivery_status,\n    onChange: function onChange(e) {\n      return setDeliveryStatus(e.target.value);\n    },\n    label: \"Estado de entrega\",\n    name: \"delivery_status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 11\n    }\n  }, SPARE_PART_DELIVERY_STATUS.map(function (value) {\n    return /*#__PURE__*/React.createElement(MenuItem, {\n      key: \"spare_part_delivery_status-\" + value,\n      value: value,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 12\n      }\n    }, spare_part_delivery_status_label(value));\n  })))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: props.from == \"request\" || from == \"quotation\" ? 6 : 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    fullWidth: true,\n    variant: \"outlined\",\n    type: \"number\",\n    InputProps: {\n      inputProps: {\n        min: 1,\n        max: 99\n      }\n    },\n    label: \"Cantidad\",\n    name: \"quantity\",\n    value: quantity,\n    onChange: function onChange(e) {\n      return handleQuantity(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }\n  })), props.from == \"quotation\" && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    fullWidth: true,\n    variant: \"outlined\",\n    label: \"Precio unitario\",\n    name: \"price\",\n    value: price,\n    onChange: function onChange(e) {\n      return setPrice(e.target.value);\n    },\n    InputProps: {\n      inputComponent: NumberFormatCustom\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 8\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mdl-navigation__link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    color: \"primary\",\n    checked: warranty,\n    onClick: function onClick(e) {\n      return handleWarrantyChange(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 9\n    }\n  }), \"\\xA0\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"quotation-product-name quotation-product-labor-price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 9\n    }\n  }, \"Esta refacci\\xF3n tiene \", /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 101\n    }\n  }, \"Garant\\xEDa\"))))), props.from == \"request\" && /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    fullWidth: true,\n    variant: \"outlined\",\n    multiline: true,\n    rows: 8,\n    label: \"Ingrese Observaciones\",\n    name: \"background\",\n    value: background,\n    onChange: function onChange(e) {\n      return setBackground(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 9\n    }\n  }))))), /*#__PURE__*/React.createElement(DialogActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: function onClick(e) {\n      return handleClose(e);\n    },\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 9\n    }\n  }, \"Cerrar\"), /*#__PURE__*/React.createElement(Button, {\n    onClick: function onClick(e) {\n      return handleEdit(e);\n    },\n    id: \"product-update\",\n    variant: \"contained\",\n    color: \"primary\",\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 9\n    }\n  }, \"Guardar\"))));\n}\n\nvar structuredSelector = createStructuredSelector({\n  customers: function customers(state) {\n    return state.customers;\n  }\n});\nvar mapDispatchToProps = {\n  editSparePart: editSparePart\n};\nexport default connect(structuredSelector, mapDispatchToProps)(EditSparePartDialog);","map":{"version":3,"sources":["/usr/src/app/javascript/components/services/EditSparePartDialog.jsx"],"names":["React","useState","useEffect","axios","connect","createStructuredSelector","TextField","Grid","FormControl","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Link","Checkbox","FormControlLabel","InputLabel","MenuItem","Select","NumberFormat","PropTypes","spare_part_delivery_status_label","flash_alert","EDIT_SPARE_PART","EDITED_SPARE_PART","SPARE_PART_DELIVERY_STATUS","NumberFormatCustom","props","inputRef","onChange","other","values","target","name","value","propTypes","func","isRequired","string","editSparePart","service_id","quotation_id","service_spare_part_id","quantity","requested_quantity","delivery_status","background","price","warranty","from","headers","callbacks","dispatch","type","body","FormData","set","patch","then","response","e","console","log","EditSparePartDialog","open","setOpen","setQuantity","setPrice","firstTime","setFirstTime","setRequestedQuantity","setFrom","setDeliveryStatus","setBackground","setWarranty","original_price","handleClickOpen","preventDefault","handleClose","handleEdit","handleQuantity","handleWarrantyChange","customer_id","tnr","map","inputProps","min","max","inputComponent","structuredSelector","customers","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from \"react-redux\"\nimport { createStructuredSelector } from \"reselect\"\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Link from '@material-ui/core/Link';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport NumberFormat from 'react-number-format';\nimport PropTypes from 'prop-types';\nimport {spare_part_delivery_status_label} from \"constants/service_functions\"\nimport { flash_alert } from 'components/App';\nconst EDIT_SPARE_PART = \"EDIT_SPARE_PART\";\nconst EDITED_SPARE_PART = \"EDITED_SPARE_PART\";\n\nconst SPARE_PART_DELIVERY_STATUS = ['waiting', 'in_transit', 'delivered']\n\nfunction NumberFormatCustom(props) {\n\tconst { inputRef, onChange, ...other } = props;\n  \n\treturn (\n\t  <NumberFormat\n\t\t{...other}\n\t\tgetInputRef={inputRef}\n\t\tonValueChange={(values) => {\n\t\t  onChange({\n\t\t\ttarget: {\n\t\t\t  name: props.name,\n\t\t\t  value: values.value,\n\t\t\t},\n\t\t  });\n\t\t}}\n\t\tthousandSeparator\n\t\tisNumericString\n\t\tprefix=\"$ \"\n\t  />\n\t);\n  }\n  \n  NumberFormatCustom.propTypes = {\n\tinputRef: PropTypes.func.isRequired,\n\tname: PropTypes.string.isRequired,\n\tonChange: PropTypes.func.isRequired,\n  };\n\nfunction editSparePart(service_id, quotation_id, service_spare_part_id, quantity, requested_quantity, delivery_status, background, price, warranty, from, headers, callbacks) {\n   return (dispatch) => {\n\t\tdispatch({type: EDIT_SPARE_PART});\n\t\tvar body = new FormData(); \n\t\tbody.set('id', service_id);\n\t\t\n\t\tif(from == \"request\"){\n\t\t\tbody.set('requested_quantity', requested_quantity);\n\t\t\tbody.set('delivery_status', delivery_status);\n\t\t\tbody.set('background', background);\n\t\t\t\n\t\t}else{\n\t\t\tbody.set('quantity', quantity);\n\t\t}\n\n\t\tif(from == \"quotation\"){\n\t\t\tbody.set('quotation_spare_part_id', service_spare_part_id);\n\t\t\tbody.set('price', price);\n\t\t\tbody.set('warranty', warranty);\n\t\t\t\n\t\t\treturn axios.patch(`/api/v1/quotations/${quotation_id}/spare_parts/${service_spare_part_id}`, body, { headers: headers})\n\t\t\t.then(response => {\n\t\t\t\tflash_alert(\"Actualizado!\", \"Refacci贸n actualizada correctamente\", \"success\")\n\t\t\t\tcallbacks();\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tflash_alert(\"Error!\", \"No se ha podido actualizar la refacci贸n\", \"danger\")\n\t\t\t\tconsole.log(e);\n\t\t\t});\n\t\t}else{\n\t\t\tbody.set('service_spare_part_id', service_spare_part_id);\n\t\t\treturn axios.patch(`/api/v1/services/${service_id}/spare_parts/${service_spare_part_id}`, body, { headers: headers})\n\t\t\t.then(response => {\n\t\t\t\tflash_alert(\"Actualizado!\", \"Refacci贸n actualizada correctamente\", \"success\")\n\t\t\t\tdispatch({type: EDITED_SPARE_PART, response});\n\t\t\t\tcallbacks && callbacks();\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tflash_alert(\"Error!\", \"No se ha podido actualizar la refacci贸n\", \"danger\")\n\t\t\t\tconsole.log(e);\n\t\t\t});\n\t\t}\n\t\t\n        \n\t};\n};\n\n\nfunction EditSparePartDialog(props){\n\tconst [open, setOpen] = useState(false);\n\n    const [quantity, setQuantity] = useState(\"\");\n\tconst [price, setPrice] = useState(\"\");\n\tconst [firstTime, setFirstTime] = useState(true);\n\t\n\t\n    const [requested_quantity, setRequestedQuantity] = useState(\"\");\n    const [from, setFrom] = useState(\"\");\n    const [delivery_status, setDeliveryStatus] = useState(\"\");\n\tconst [background, setBackground] = useState(\"\");\n\n\tconst [warranty, setWarranty] = useState(false);\n\t\n    useEffect(() => {\n\t\tsetQuantity(props.quantity)\n\t},[props.quantity]);\n\n\tuseEffect(() => {\n\t\tif(props.price){\n\t\t\tsetPrice(props.price)\n\t\t}\n\t\tprops.price == 0 && setWarranty(true)\n\t},[props.price]);\n\n\n\tuseEffect(() => {\n\t\tif(price){\n\t\t\tprice == 0 ?  null : setWarranty(false)\n\t\t}\n\t},[price])\n\n\tuseEffect(() => {\n\t\tif(!warranty){\t\t\t\n\t\t\tif(props.original_price && !firstTime){\n\t\t\t\tsetPrice(props.original_price)\n\t\t\t}else{\n\t\t\t\tsetPrice(props.price)\n\t\t\t}\n\t\t\t\n\t\t}else{\n\t\t\tsetPrice(0)\n\t\t}\n\t\tfirstTime && setFirstTime(false)\n\t},[warranty])\n\n\n\n\tuseEffect(() => {\n\t\tsetRequestedQuantity(props.requested_quantity)\n\t},[props.requested_quantity]);\n\n\tuseEffect(() => {\n\t\tsetDeliveryStatus(props.delivery_status)\n\t},[props.delivery_status]);\n\n\tuseEffect(() => {\n\t\tsetBackground(props.background)\n\t},[props.background]);\n\n\t\n\n\n\tuseEffect(() => {\n\t\tsetFrom(props.from)\n\t\tif(props.from == \"request\"){\n\t\t\tsetQuantity(props.requested_quantity)\n\t\t}\n\t},[props.from]);\n\n\n\tfunction handleClickOpen(e){\n\t\te.preventDefault();\n\t\tsetOpen(true);\n\t}\n\n\tfunction handleClose(e){\n\t\te.preventDefault();\n\t\tsetOpen(false);\n\t}\n\n\tasync function handleEdit(e){\n\t\te.preventDefault();\n\t\tsetOpen(false);\n\t\tprops.editSparePart(props.service_id, props.quotation_id, props.service_spare_part_id, quantity, requested_quantity, delivery_status, background, price, warranty, from, props.headers, props.callbacks);\n\t}\n\t\n\tfunction handleQuantity(e){\n\t\tif(e.target.value < 1 || e.target.value > 99){\n\t\t\tflash_alert(\"Error!\", \"Debe ingresar una cantidad entre 1 y 99\", \"danger\")\n\t\t}\n\t\telse{\n\t\t\tsetQuantity(e.target.value)\n\t\t\tsetRequestedQuantity(e.target.value)\n\t\t}\n\t}\n\n\n    function handleWarrantyChange(e){\n\t\tsetWarranty(!warranty)\n    }\n    \n\treturn (\n\t\t<React.Fragment>\n\t\t  <Link href=\"#\" id={\"editspareparts_\"+props.customer_id} className=\"mdl-navigation__link brand-primary-link sparepart-edit-link  mg-r-15\" onClick={handleClickOpen}><i className=\"material-icons material-icons-20\">edit</i> Editar</Link>\n\t\t  <Dialog\n\t\t\topen={open}\n\t\t\tfullWidth={true}\n        \tmaxWidth={\"sm\"}\n\t\t    onClose={handleClose}\n\t\t    aria-labelledby=\"alert-dialog-title\"\n\t\t    aria-describedby=\"alert-dialog-description\"\n\t\t  >\n\t\t    <DialogTitle className=\"edit-sparepart-dialog-title\"  id=\"alert-dialog-title\">{\"Editar refacci贸n\"}</DialogTitle>\n\t\t    <DialogContent>\n\t\t      <DialogContentText id=\"alert-dialog-description\">\n\t\t\t\t<Grid container spacing={1}>\n\t\t\t\t\t<Grid item xs={12} sm={12} className={\"edit-sparepart-dialog-product-name\"}>\n\t\t        \t\t{props.name} ({props.tnr})\n\t\t\t\t\t</Grid>\n\t\t\t\t\t{\n\t\t\t\t\t\tprops.from == \"request\" && \n\t\t\t\t\t\t\t<Grid item xs={12} sm={6}>\n\t\t\t\t\t\t\t\t<FormControl variant=\"outlined\" className=\"MuiFormControl-fullWidth\" >\n\t\t\t\t\t\t\t\t\t\t<InputLabel id=\"spare_part_delivery_status-simple-select-outlined-label\">Estado de entrega</InputLabel>\n\t\t\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\t\tlabelId=\"spare_part_delivery_status-simple-select-outlined-label\"\n\t\t\t\t\t\t\t\t\t\tid=\"spare_part_delivery_status-simple-select-outlined\"\n\t\t\t\t\t\t\t\t\t\tvalue={delivery_status}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setDeliveryStatus(e.target.value)}\n\t\t\t\t\t\t\t\t\t\tlabel=\"Estado de entrega\"\n\t\t\t\t\t\t\t\t\t\tname=\"delivery_status\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{SPARE_PART_DELIVERY_STATUS.map((value) => (\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem key={\"spare_part_delivery_status-\"+value} value={value}>{spare_part_delivery_status_label(value)}</MenuItem>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t</Grid>\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t<Grid item xs={12} sm={(props.from == \"request\" || from == \"quotation\") ? 6 : 12}>\n\t\t\t\t\t\t<TextField fullWidth variant=\"outlined\" type=\"number\" InputProps={{ inputProps: { min: 1, max: 99 } }} label=\"Cantidad\" name=\"quantity\" value={quantity} onChange={(e) => handleQuantity(e)}/>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t{\n\t\t\t\t\t\tprops.from == \"quotation\" &&\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t<Grid item xs={12} sm={6}>\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\tfullWidth \n\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\tlabel=\"Precio unitario\"\n\t\t\t\t\t\t\t\tname=\"price\" \n\t\t\t\t\t\t\t\tvalue={price}\n\t\t\t\t\t\t\t\tonChange={(e) => setPrice(e.target.value)}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\tinputComponent: NumberFormatCustom,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t\t<span className=\"mdl-navigation__link\">\n\t\t\t\t\t\t\t\t<Checkbox color=\"primary\" checked={warranty} onClick={(e) => handleWarrantyChange(e)} />\n\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\t<span className=\"quotation-product-name quotation-product-labor-price\">Esta refacci贸n tiene <strong>Garant铆a</strong></span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t</>\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\tprops.from == \"request\" && \n\t\t\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t\t\t<TextField \n\t\t\t\t\t\t\t\t\tfullWidth variant=\"outlined\" multiline rows={8} \n\t\t\t\t\t\t\t\t\tlabel=\"Ingrese Observaciones\"\n\t\t\t\t\t\t\t\t\tname=\"background\" \n\t\t\t\t\t\t\t\t\tvalue={background} \n\t\t\t\t\t\t\t\t\tonChange={(e) => setBackground(e.target.value)} />\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t}\n\t\t\t\t</Grid>  \n\t\t      </DialogContentText>\n\t\t    </DialogContent>\n\t\t    <DialogActions>\n\t\t      <Button onClick={(e) => handleClose(e)} color=\"primary\">\n\t\t        Cerrar\n\t\t      </Button>\n\t\t      <Button onClick={(e) => handleEdit(e) } id=\"product-update\"  variant=\"contained\" color=\"primary\" autoFocus>\n\t\t        Guardar\n\t\t      </Button>\n\t\t    </DialogActions>\n\t\t  </Dialog>\n\t\t</React.Fragment>\n\t);\n  \n}\n\nconst structuredSelector = createStructuredSelector({\n  customers: state => state.customers\n});\nconst mapDispatchToProps = {editSparePart};\n\nexport default connect(structuredSelector, mapDispatchToProps)(EditSparePartDialog)\n"]},"metadata":{},"sourceType":"module"}