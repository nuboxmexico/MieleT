{"ast":null,"code":"import axios from 'axios';\nimport { flash_alert } from 'components/App';\nimport { csrf, headers } from \"constants/csrf\";\nexport function callMastercardGateway(provider, object_id, customer_id, amount, object_class) {\n  checkoutLightbox(provider, object_id, customer_id, amount, object_class);\n}\nexport function checkoutLightbox(provider, object_id, customer_id, amount, object_class) {\n  return axios.get(\"/mastercard_lightbox/\".concat(provider, \"/\").concat(object_id, \".json?customer_id=\").concat(customer_id, \"&amount=\").concat(amount, \"&object_class=\").concat(object_class)).then(function (json) {\n    var script = document.getElementById(provider);\n\n    if (script == null) {\n      script = document.createElement('script');\n      script.src = json.data.checkout_url;\n      script.setAttribute(\"id\", provider);\n      script.setAttribute(\"data-error\", \"\".concat(json.data.error_callback_url, \"?object_id=\").concat(object_id, \"&customer_id=\").concat(customer_id));\n      script.setAttribute(\"data-cancel\", \"\".concat(json.data.cancel_callback_url, \"?object_id=\").concat(object_id, \"&customer_id=\").concat(customer_id));\n      script.setAttribute(\"data-complete\", \"\".concat(json.data.complete_callback_url, \"?object_id=\").concat(object_id, \"&customer_id=\").concat(customer_id));\n      document.body.appendChild(script);\n    }\n\n    script.addEventListener('load', function () {\n      Checkout.configure(json.data.checkout_configuration);\n      Checkout.showLightbox();\n    });\n  })[\"catch\"](function (e) {\n    flash_alert(\"Error\", \"Ha ocurrido un error intentando procesar el pago.\", \"danger\");\n  });\n}\nexport function savePaymentData(resultIndicator, sessionVersion, provider_id, payment_id, setRedirect) {\n  var body = new FormData();\n  body.set('payment_id', payment_id);\n  body.set('result_indicator', resultIndicator);\n  body.set('session_version', sessionVersion);\n  body.set('provider_id', provider_id);\n  return axios.post('/payment/save_data', body, {\n    headers: headers\n  }).then(function (response) {\n    console.log(response);\n    flash_alert(\"Creado\", \"EL pago se ha realizado satisfactoriamente\", \"success\");\n    setRedirect(true);\n  })[\"catch\"](function (e) {\n    flash_alert(\"Error\", \"Ha ocurrido un error intentando procesar el pago.\", \"danger\");\n  });\n}","map":{"version":3,"sources":["/usr/src/app/javascript/constants/mastercard_functions.jsx"],"names":["axios","flash_alert","csrf","headers","callMastercardGateway","provider","object_id","customer_id","amount","object_class","checkoutLightbox","get","then","json","script","document","getElementById","createElement","src","data","checkout_url","setAttribute","error_callback_url","cancel_callback_url","complete_callback_url","body","appendChild","addEventListener","Checkout","configure","checkout_configuration","showLightbox","e","savePaymentData","resultIndicator","sessionVersion","provider_id","payment_id","setRedirect","FormData","set","post","response","console","log"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport { flash_alert } from 'components/App';\nimport { csrf, headers} from \"constants/csrf\"\n\n\nexport function callMastercardGateway(provider, object_id, customer_id, amount, object_class) {\n    checkoutLightbox(provider, object_id, customer_id, amount, object_class);\n}\n\nexport function checkoutLightbox(provider, object_id, customer_id, amount, object_class) {  \n    return axios.get(`/mastercard_lightbox/${provider}/${object_id}.json?customer_id=${customer_id}&amount=${amount}&object_class=${object_class}`)\n        .then(json => {\n            let script = document.getElementById(provider)\n            if(script == null){\n                script = document.createElement('script');\n                script.src = json.data.checkout_url;\n                script.setAttribute(\"id\", provider)\n                script.setAttribute(\"data-error\", `${json.data.error_callback_url}?object_id=${object_id}&customer_id=${customer_id}`)\n                script.setAttribute(\"data-cancel\", `${json.data.cancel_callback_url}?object_id=${object_id}&customer_id=${customer_id}`)\n                script.setAttribute(\"data-complete\", `${json.data.complete_callback_url}?object_id=${object_id}&customer_id=${customer_id}`)\n                \n                document.body.appendChild(script);\n            }\n            \n            script.addEventListener('load', function() {\n                Checkout.configure(json.data.checkout_configuration);\n                Checkout.showLightbox();\n            });\n\n        })\n        .catch(e => {\n            flash_alert(\"Error\", \"Ha ocurrido un error intentando procesar el pago.\", \"danger\")\n                \n    });    \n}\n\nexport function savePaymentData(resultIndicator, sessionVersion, provider_id, payment_id, setRedirect){\n    var body = new FormData();\n    body.set('payment_id', payment_id);\n    body.set('result_indicator', resultIndicator);\n    body.set('session_version', sessionVersion);\n    body.set('provider_id', provider_id);\n    \n    return axios.post('/payment/save_data', body, { headers: headers})\n        .then(response => {\n            console.log(response)\n            flash_alert(\"Creado\", \"EL pago se ha realizado satisfactoriamente\", \"success\")\n                setRedirect(true);\n            })\n        .catch(e => {\n            flash_alert(\"Error\", \"Ha ocurrido un error intentando procesar el pago.\", \"danger\")\n                \n    });\n}\n"]},"metadata":{},"sourceType":"module"}