{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/javascript/components/customers/Searcher.jsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { buildFullName } from 'components/customers/utils';\nimport { InputPicker } from 'rsuite';\nimport SpinnerIcon from '@rsuite/icons/legacy/Spinner';\nimport { Box } from \"@material-ui/core\";\nimport axios from \"axios\";\nimport 'assets/custom-rsuite.css';\nimport { useTranslation } from 'react-i18next';\n\nfunction Searcher(props) {\n  var _this = this;\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t; // TODO: Rebuild all with MUI\n\n\n  var customersMapped = props.customersMapped,\n      setCustomersMapped = props.setCustomersMapped,\n      selectedCustomer = props.selectedCustomer,\n      setSelectedCustomer = props.setSelectedCustomer;\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var initialStateCustomers = Object.keys(selectedCustomer).length > 0 ? [selectedCustomer] : [];\n\n  var _useState3 = useState(initialStateCustomers),\n      _useState4 = _slicedToArray(_useState3, 2),\n      customers = _useState4[0],\n      setCustomers = _useState4[1];\n\n  function getCustomers() {\n    return _getCustomers.apply(this, arguments);\n  }\n\n  function _getCustomers() {\n    _getCustomers = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var keywords,\n          _yield$axios$get,\n          data,\n          newCustomers,\n          _args = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              keywords = _args.length > 0 && _args[0] !== undefined ? _args[0] : \"\";\n              setLoading(true);\n              _context.next = 4;\n              return axios.get('/api/v1/customers', {\n                params: {\n                  keywords: keywords\n                }\n              });\n\n            case 4:\n              _yield$axios$get = _context.sent;\n              data = _yield$axios$get.data;\n              newCustomers = data.data.filter(function (customer) {\n                return customer.unit_real_state_id === null;\n              });\n              setCustomers(newCustomers);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getCustomers.apply(this, arguments);\n  }\n\n  useEffect(function () {\n    if (!(customers.length > 0)) return;\n    var newCustomersMapped = customers.map(function (customer) {\n      return {\n        label: buildFullName(customer),\n        value: customer.id\n      };\n    });\n    setCustomersMapped(newCustomersMapped);\n    setLoading(false);\n    console.log({\n      newCustomersMapped: newCustomersMapped\n    });\n    console.log({\n      customers: customers\n    });\n  }, [customers]);\n\n  function handleSelectedCustomer(newSelectedCustomerId) {\n    var newSelectedCustomer = customers.find(function (customer) {\n      return customer.id === newSelectedCustomerId;\n    });\n    setSelectedCustomer(newSelectedCustomer);\n  }\n\n  return /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(InputPicker, {\n    data: customersMapped,\n    style: {\n      height: \"100%\",\n      width: \"100%\"\n    },\n    onSearch: getCustomers,\n    placeholder: t('customer.projectCustomer.searcher'),\n    onSelect: handleSelectedCustomer,\n    defaultValue: (selectedCustomer === null || selectedCustomer === void 0 ? void 0 : selectedCustomer.id) || \"\",\n    renderMenu: function renderMenu(menu) {\n      if (loading) {\n        return /*#__PURE__*/React.createElement(\"p\", {\n          style: {\n            padding: 10,\n            color: '#999',\n            textAlign: 'center'\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(SpinnerIcon, {\n          spin: true,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 17\n          }\n        }), \" \", t('customer.projectCustomer.typeToSearch'));\n      }\n\n      return menu;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default Searcher;","map":{"version":3,"sources":["/usr/src/app/javascript/components/customers/Searcher.jsx"],"names":["React","useState","useEffect","buildFullName","InputPicker","SpinnerIcon","Box","axios","useTranslation","Searcher","props","t","customersMapped","setCustomersMapped","selectedCustomer","setSelectedCustomer","loading","setLoading","initialStateCustomers","Object","keys","length","customers","setCustomers","getCustomers","keywords","get","params","data","newCustomers","filter","customer","unit_real_state_id","newCustomersMapped","map","label","value","id","console","log","handleSelectedCustomer","newSelectedCustomerId","newSelectedCustomer","find","height","width","menu","padding","color","textAlign"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\"\nimport {buildFullName} from 'components/customers/utils'\nimport {InputPicker} from 'rsuite';\nimport SpinnerIcon from '@rsuite/icons/legacy/Spinner';\nimport {Box} from \"@material-ui/core\";\nimport axios from \"axios\"\nimport 'assets/custom-rsuite.css'\nimport { useTranslation } from 'react-i18next';\n\nfunction Searcher(props) {\n  const {t} = useTranslation();\n  // TODO: Rebuild all with MUI\n  const {\n    customersMapped, setCustomersMapped,\n    selectedCustomer, setSelectedCustomer,\n  } = props\n\n  const [loading, setLoading] = useState(true)\n  const initialStateCustomers = Object.keys(selectedCustomer).length > 0 ? [selectedCustomer] : []\n  const [customers, setCustomers] = useState(initialStateCustomers)\n\n  async function getCustomers(keywords = \"\") {\n    setLoading(true)\n    const {data} = await axios.get('/api/v1/customers', {params: {keywords}})\n    const newCustomers = data.data.filter((customer) => customer.unit_real_state_id === null)\n    setCustomers(newCustomers)\n  }\n\n  useEffect(() => {\n    if (!(customers.length > 0)) return\n\n    const newCustomersMapped = customers.map((customer) => ({label: buildFullName(customer), value: customer.id}))\n    setCustomersMapped(newCustomersMapped)\n    setLoading(false)\n    console.log({newCustomersMapped});\n    console.log({customers});\n  }, [customers])\n\n  function handleSelectedCustomer(newSelectedCustomerId) {\n    const newSelectedCustomer = customers.find((customer) => customer.id === newSelectedCustomerId)\n    setSelectedCustomer(newSelectedCustomer)\n  }\n\n  return (\n    <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\n      <InputPicker\n        data={customersMapped}\n        style={{height: \"100%\", width: \"100%\"}}\n        onSearch={getCustomers}\n        placeholder={t('customer.projectCustomer.searcher')}\n        onSelect={handleSelectedCustomer}\n        defaultValue={selectedCustomer?.id || \"\"}\n        renderMenu={menu => {\n          if (loading) {\n            return (\n              <p style={{padding: 10, color: '#999', textAlign: 'center'}}>\n                <SpinnerIcon spin /> {t('customer.projectCustomer.typeToSearch')}\n              </p>\n            );\n          }\n          return menu;\n        }}\n      />\n    </Box>\n  )\n}\n\nexport default Searcher\n"]},"metadata":{},"sourceType":"module"}